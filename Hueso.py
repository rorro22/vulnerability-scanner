import Rastreador
import tkinter as tk
from tkinter import simpledialog

def set_target_url():
    target_url = url_entry.get()
    escaner = Rastreador.rastreador(target_url, ["#"])
    
    # Redirigir la salida a un widget de texto
    output_text.delete(1.0, tk.END)  # Limpiar el texto anterior
    output_text.insert(tk.END, f"Iniciando escaneo en {target_url}\n\n")
    output_text.update_idletasks()  # Actualizar el widget de texto
    
    escaner.crawl()
    
    # Imprimir los enlaces en el widget de texto
    for link in escaner.target_links:
        output_text.insert(tk.END, link + "\n")
        output_text.update_idletasks()  # Actualizar el widget de texto
        
    escaner.run_scanner()
    
    if not escaner.vulnerabilities_found:
            output_text.insert(tk.END, f"------------------------------------------------------- \n\n PAGINA SEGURA ;) porque tu amigo UAG soy {target_url}\n\n")
    else:
        output_text.insert(tk.END, f"TOTALMENTE INSEGURO :( porque tu amigo UAG soy {target_url}\n\n")

# Crear la ventana de la interfaz gr치fica
root = tk.Tk()
root.title("Esc치ner XSS")
root.geometry("450x500")

# Etiqueta y entrada para la URL objetivo
url_label = tk.Label(root, text="URL Objetivo:")
url_label.pack()

url_entry = tk.Entry(root)
url_entry.pack()

# Bot칩n para iniciar el escaneo
start_button = tk.Button(root, text="Iniciar Escaneo", command=set_target_url)
start_button.pack()

# Widget de texto para mostrar la salida
output_text = tk.Text(root, height=30, width=60)
output_text.pack()

# Iniciar la aplicaci칩n
root.mainloop()
